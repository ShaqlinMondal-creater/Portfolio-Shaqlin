<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Projects</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

  <style>
    body{font-family:Inter,system-ui,Arial;background:#0f172a;color:#e5e7eb;margin:0;padding:20px}
    .container{max-width:1100px;margin:0 auto}
    .gradient-text{background:linear-gradient(90deg,#60a5fa,#22d3ee);-webkit-background-clip:text;color:transparent}
    .glass-effect{background:rgba(255,255,255,.06);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.08)}
    .tab-pill{padding:.55rem .95rem;border:1px solid rgba(59,130,246,.3);background:rgba(59,130,246,.08);color:#93c5fd;border-radius:9999px;font-size:.9rem;text-decoration:none}
    .active-tab{background:rgba(16,185,129,.12)!important;border-color:rgba(16,185,129,.4)!important;color:#86efac!important}
    .tag-sm{padding:.25rem .6rem;background:rgba(255,255,255,.08);border-radius:9999px;font-size:.7rem}
    .grid{display:grid;gap:1.5rem}
    @media (min-width:768px){.grid.c2{grid-template-columns:repeat(2,1fr)}}
    @media (min-width:1024px){.grid.c3{grid-template-columns:repeat(3,1fr)}}
    .rounded-2xl{border-radius:1rem;overflow:hidden}
    .project-card img{width:100%;height:12rem;object-fit:cover;display:block}
    .visit-btn{display:inline-flex;align-items:center;font-size:.9rem;color:#cbd5e1;cursor:pointer}
    .skeleton{animation:pulse 1.5s ease-in-out infinite;background:rgba(255,255,255,.06);border-radius:.5rem}
    @keyframes pulse{0%{opacity:.6}50%{opacity:1}100%{opacity:.6}}
  </style>

  <script>
    const TITLE_MAP = {
      ecommerce: 'E-commerce Projects',
      woocommerce: 'WooCommerce Projects',
      institution: 'Institution Portal Projects',
      // inventory: 'Inventory Management Projects',
      portfolio: 'Company Portfolio Projects'
    };

    async function loadProjects() {
      const params = new URLSearchParams(location.search);
      const type = (params.get('type') || 'ecommerce').toLowerCase();

      // Activate tab
      document.querySelectorAll('[data-tab]').forEach(tab => {
        tab.classList.toggle('active-tab', tab.dataset.tab === type);
      });

      // Title
      const h = document.getElementById('page-title');
      if (h) h.textContent = TITLE_MAP[type] || 'Projects';

      // Fetch JSON
      const grid = document.getElementById('projects-grid');
      showSkeleton(grid);

      try {
        const res = await fetch('Json/projects.json', { cache: 'no-store' });
        if (!res.ok) throw new Error('Failed to load projects.json');
        const data = await res.json();

        // Filter by type and render
        const items = (data?.projects || []).filter(p => p.type === type);
        renderCards(grid, items);

        // If empty
        if (!items.length) {
          grid.innerHTML = `
            <div class="col-span-full text-center text-slate-400">
              No projects found for this category yet.
            </div>`;
        }
      } catch (err) {
        console.error(err);
        grid.innerHTML = `
          <div class="col-span-full text-center text-rose-300">
            Could not load projects. Please try again later.
          </div>`;
      }
    }

    function showSkeleton(grid) {
      grid.innerHTML = '';
      for (let i = 0; i < 6; i++) {
        const card = document.createElement('div');
        card.className = 'glass-effect rounded-2xl overflow-hidden';
        card.innerHTML = `
          <div class="skeleton" style="height:12rem;"></div>
          <div class="p-6">
            <div class="skeleton" style="height:24px;width:60%;margin-bottom:.75rem;"></div>
            <div class="skeleton" style="height:14px;width:90%;margin-bottom:1rem;"></div>
            <div class="flex gap-2 mb-4">
              <div class="skeleton" style="height:22px;width:70px;border-radius:9999px;"></div>
              <div class="skeleton" style="height:22px;width:70px;border-radius:9999px;"></div>
              <div class="skeleton" style="height:22px;width:70px;border-radius:9999px;"></div>
            </div>
            <div class="skeleton" style="height:18px;width:110px;"></div>
          </div>`;
        grid.appendChild(card);
      }
    }

    function renderCards(grid, items) {
      grid.innerHTML = '';
      items.forEach(item => {
        const card = document.createElement('div');
        card.className = 'project-card glass-effect rounded-2xl';
        card.setAttribute('data-type', item.type);
        card.innerHTML = `
          <img src="${item.image}" alt="${escapeHtml(item.name)}">
          <div class="p-6">
            <h3 class="text-xl font-bold" style="color:#93c5fd;margin-bottom:.35rem">${escapeHtml(item.name)}</h3>
            <p style="color:#94a3b8;margin-bottom:1rem">${escapeHtml(item.description)}</p>
            <div style="display:flex;gap:.4rem;flex-wrap:wrap;margin-bottom:1rem">
              ${item.tags.map(t => `<span class="tag-sm">${escapeHtml(t)}</span>`).join('')}
            </div>
            <button class="visit-btn" onclick="window.open('${item.url}','_blank')">
              <i class="fas fa-external-link-alt mr-2"></i>Visit
            </button>
          </div>`;
        grid.appendChild(card);
      });
    }

    function escapeHtml(str = '') {
      return str.replace(/[&<>"']/g, s => ({
        '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;'
      })[s]);
    }

    document.addEventListener('DOMContentLoaded', loadProjects);
  </script>
</head>
<body>
  <!-- Top-right Home button -->
  <a href="index.html" aria-label="Go to Home"
    class="fixed top-5 right-5 z-50 glass-effect rounded-full border border-white/10
            px-4 py-2 flex items-center gap-2 text-slate-200 hover:text-emerald-200
            hover:border-emerald-400/40 hover:bg-white/10 transition group">
    <span class="hidden sm:inline text-sm">Home</span>
    <i class="fa-solid fa-arrow-left transform transition group-hover:translate-x-0.5"></i>
  </a>

  <section class="py-8">
    <div class="container">
      <h2 id="page-title" class="text-4xl font-bold text-center mb-10 gradient-text">Projects</h2>

      <!-- Tabs -->
      <div class="flex flex-wrap justify-center gap-2 mb-6">
        <a class="tab-pill" data-tab="ecommerce"   href="?type=ecommerce">E-commerce</a>
        <a class="tab-pill" data-tab="woocommerce" href="?type=woocommerce">WooCommerce</a>
        <a class="tab-pill" data-tab="institution" href="?type=institution">Institution Portal</a>
        <!-- <a class="tab-pill" data-tab="inventory"   href="?type=inventory">Inventory Management</a> -->
        <a class="tab-pill" data-tab="portfolio"   href="?type=portfolio">Company Portfolio</a>
      </div>

      <!-- Cards (injected from JSON) -->
      <div id="projects-grid" class="grid c2 c3"></div>
    </div>
  </section>
</body>
</html>
